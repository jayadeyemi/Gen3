---
module:
  - commons-gke:
    source: ../../../modules/gke
    project: ${data.terraform_remote_state.org_setup.project_id}
    region: ${var.cluster_region}
    cluster_name: ${var.cluster_name}
    node_name: ${var.node_name}
    network: ${data.terraform_remote_state.project_setup.network_name_commons_private}
    environment: ${var.env}
    create_subnetwork: false
    master_ipv4_cidr_block: ${var.master_ipv4_cidr_block}
    cluster_secondary_range_name: ${var.commons_private_subnet_secondary_name2}
    services_secondary_range_name: ${var.commons_private_subnet_secondary_name1}
    subnetwork_name: ${element(data.terraform_remote_state.project_setup.subnetwork_name__commons_private, 0)}
    node_labels: ${var.node_labels}
    node_tags:
      - ${data.terraform_remote_state.project_setup.firewall_commons_egress_allow_proxy_port_target_tags}
    master_version: ${var.min_master_version}
    master_authorized_network_name: ${var.master_authorized_network_name}
    master_authorized_cidr_block: ${data.terraform_remote_state.csoc_project_setup.cloud_nat_external_ip.0}/32
    use_ip_aliases: ${var.use_ip_aliases}
    enable_private_endpoint: ${var.enable_private_endpoint}
    node_ipv4_cidr_block: ${var.node_ipv4_cidr_block}
    initial_node_count: ${var.initial_node_count}
    min_node_cout: ${var.min_node_cout}
    max_node_count: ${var.max_node_count}
    default_node_pool: ${var.default_node_pool}
    enable_private_nodes: ${var.enable_private_nodes}
    preemptible: ${var.preemptible}
    image_type: ${var.image_type}
    node_auto_upgrade: ${var.node_auto_upgrade}
    prod_machine_type: ${var.prod_machine_type}
    dev_machine_type: ${var.dev_machine_type}
    node_auto_repair: ${var.node_auto_repair}
    network_policy: ${var.network_policy}
    daily_maintenance_window: ${var.daily_maintenance_window}
    kubernetes_dashboard: ${var.kubernetes_dashboard}
    cluster_ipv4_cidr_block: ${var.cluster_ipv4_cidr_block}
    services_ipv4_cidr_block: ${var.services_ipv4_cidr_block}
    horizontal_pod_autoscaling: ${var.horizontal_pod_autoscaling}
    http_load_balancing: ${var.http_load_balancing}
    network_policy_config: ${var.network_policy_config}
    disk_type: ${var.disk_type}
    disk_size_gb: ${var.disk_size_gb}
    oauth_scopes:
      - ${var.scopes}
