---
data:
  - aws_ami:
    ubuntu:
      most_recent: true
      filter:
        - name: name
        values:
          - ubuntu/images/hvm-ssd/ubuntu-bionic-18.04-amd64-server-*
        - name: virtualization-type
        values:
          - hvm
      owners:
        - '099720109477'
  - aws_iam_policy_document:
    child_policy_document:
      statement:
        - actions:
          - logs:CreateLogGroup
          - logs:CreateLogStream
          - logs:GetLogEvents
          - logs:PutLogEvents
          - logs:DescribeLogGroups
          - logs:DescribeLogStreams
          - logs:PutRetentionPolicy
        effect: Allow
        resources:
          - '*'
        - actions:
          - sts:AssumeRole
        effect: Allow
        resources:
          - arn:aws:iam::${var.child_account_id}:role/csoc_adminvm
