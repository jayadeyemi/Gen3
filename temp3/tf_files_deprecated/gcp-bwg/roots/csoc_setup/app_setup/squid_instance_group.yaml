---
module:
  squid_instance_group:
    source: ../../../modules/compute-group-autoheal
    name: ${var.squid_name}
    project: ${data.terraform_remote_state.org_setup.project_id}
    network_interface: ${data.terraform_remote_state.project_setup.network_name_csoc_egress}
    subnetwork: ${data.terraform_remote_state.project_setup.network_subnetwork_csoc_egress.0}
    tags:
      ${data.terraform_remote_state.project_setup.firewall-csoc-egress-inboud-proxy-port-target-tags}
      ${data.terraform_remote_state.project_setup.firewall-csoc-egress-outbound-web-target-tags}
    metadata_startup_script: ${var.squid_metadata_startup_script}
    machine_type: ${var.squid_machine_type}
    base_instance_name: ${var.squid_base_instance_name}
    zone: ${var.squid_zone}
    region: ${var.region}
    target_size: ${var.squid_target_size}
    target_pool_name: ${var.squid_target_pool_name}
    source_image: ${var.squid_source_image}
    instance_template_name: ${var.squid_instance_template_name}
    instance_group_manager_name: ${var.squid_instance_group_manager_name}
    automatic_restart: ${var.squid_automatic_restart}
    on_host_maintenance: ${var.squid_on_host_maintenance}
    labels: ${var.squid_labels}
    access_config: ${var.squid_access_config}
    network_ip: ${var.squid_network_ip}
    can_ip_forward: ${var.squid_can_ip_forward}
    hc_name: ${var.squid_name}-${var.squid_hc_name}
    hc_check_interval_sec: ${var.squid_hc_check_interval_sec}
    hc_timeout_sec: ${var.squid_hc_timeout_sec}
    hc_healthy_threshold: ${var.squid_hc_healthy_threshold}
    hc_unhealthy_threshold: ${var.squid_hc_unhealthy_threshold}
    hc_tcp_health_check_port: ${var.squid_hc_tcp_health_check_port}
