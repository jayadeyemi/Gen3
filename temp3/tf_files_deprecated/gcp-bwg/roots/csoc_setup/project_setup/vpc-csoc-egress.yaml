---
module:
  vpc-csoc-egress:
    source: ../../../modules/vpc
    project_id: ${data.terraform_remote_state.org_setup.project_id}
    network_name: ${var.csoc_egress_network_name}
    create_vpc_secondary_ranges: ${var.create_vpc_secondary_ranges}
    subnets:
      subnet_name: ${var.csoc_egress_subnet_name}
      subnet_ip: ${var.csoc_egress_subnet_ip}
      subnet_region: ${var.csoc_egress_region}
      subnet_flow_logs: ${var.csoc_egress_subnet_flow_logs}
      subnet_private_access: ${var.csoc_egress_subnet_private_access}
    secondary_ranges:
      ${var.csoc_egress_subnet_name}:
        range_name: ${var.range_name_k8_service}
        ip_cidr_range: ${var.ip_cidr_range_k8_service}
        range_name: ${var.range_name_k8_pod}
        ip_cidr_range: ${var.ip_cidr_range_k8_pod}
    routes:
      name: ${var.csoc_egress_network_name}-${var.google_apis_route}
      destination_range: 199.36.153.4/30
      next_hop_internet: 'true'
      name: ${var.csoc_egress_network_name}-default-route
      destination_range: 0.0.0.0/0
      next_hop_internet: 'true'
